<div class="assignment-drawer"
    data-controller="toggle-user"
    data-toggle-user-project-id-value="<%= @project.id %>">

  <!-- 閉じるボタン -->
  <%= link_to manager_assignments_path, class: "close" do %>
    <%= image_tag "menu__close.svg", alt: "閉じる" %>
  <% end %>

  <!-- ヘッダー -->
  <div class="assignment-header">
    <h2 class="assignment-date">
      <%= japanese_short_date_with_weekday(@project.work_date) %>
      <%= @project.start_time.strftime("%H:%M") %>〜<%= @project.end_time.strftime("%H:%M") %>
    </h2>
    <div class="assignment-meta">
      <span class="assignment-location"><%= @project.location %></span>
      <span class="assignment-title"><%= @project.title %></span>
    </div>
    <div class="assignment-required">
      必要人数：<strong><%= @project.required_number %>人</strong>
      （あと<strong><%= @project.required_number - @assigned_users.size %>人</strong>）
    </div>
  </div>

  <!-- 確定済みセクション -->
  <div class="panel panel--success assignment-section">
    <div class="panel__header">
      <%= image_tag "icon__check.svg", class: "icon-sm", alt: "確定済み" %>
      <span class="panel__title">確定済み</span>
    </div>
    <div class="panel__body assignment-list">
      <% @assigned_users.each do |sa| %>
        <button type="button"
                class="chip chip--primary"
                data-action="click->toggle-user#toggle"
                data-toggle-user-user-id-value="<%= sa.user.id %>">
          <%= sa.user.name %>
        </button>
      <% end %>
    </div>
  </div>

  <!-- 希望提出者セクション -->
  <div class="panel panel--info assignment-section">
    <div class="panel__header">
      <%= image_tag "icon__warning_blue.svg", class: "icon-sm", alt: "シフト希望" %>
      <span class="panel__title">シフト希望提出者</span>
    </div>
    <div class="panel__body assignment-list">
      <% @shift_requests.each do |req| %>
        <button type="button"
                class="chip"
                data-action="click->toggle-user#toggle"
                data-toggle-user-user-id-value="<%= req.user.id %>">
          <%= req.user.name %>
        </button>
      <% end %>
    </div>
  </div>

  <!-- アクションボタン -->
  <div class="assignment-actions">
    <%= button_to "割り当て完了",
                  complete_assignment_manager_project_path(@project),
                  method: :patch,
                  class: "btn btn--primary" %>
  </div>
</div>
